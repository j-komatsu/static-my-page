<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Page</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="App">
    <!-- ヘッダー部分 -->
    <header class="main-header">
      <!-- ページタイトルセクション -->
      <div class="title-header">
        <div class="title-left">
          <h1 id="main-title" onclick="editMainTitle()">My Page</h1>
          <input type="text" id="main-title-input" class="title-input" onblur="saveMainTitle()" onkeypress="handleMainTitleKeypress(event)" />
        </div>
        <!-- Pomodoro Timer (in header) -->
        <div id="pomodoro-timer-container" class="pomodoro-timer-container pomodoro-in-header">
          <div class="pomodoro-timer">
            <div class="pomodoro-header">
              <h3 class="pomodoro-title">ポモドーロタイマー</h3>
              <div class="pomodoro-controls-header">
                <button class="pomodoro-settings-btn" onclick="openPomodoroSettings()" title="設定">⚙️</button>
                <button class="pomodoro-toggle-btn" onclick="togglePomodoroVisibility()" title="最小化">−</button>
              </div>
            </div>

            <div class="pomodoro-body">
              <div class="pomodoro-mode-indicator">
                <span id="pomodoro-mode-text">作業時間</span>
                <span id="pomodoro-session-count">セッション: 0</span>
              </div>

              <div class="pomodoro-timer-display" id="pomodoro-timer-display">
                25:00
              </div>

              <div class="pomodoro-controls">
                <button class="pomodoro-btn pomodoro-start-btn" onclick="togglePomodoroTimer()" id="pomodoro-start-btn">
                  開始
                </button>
                <button class="pomodoro-btn pomodoro-reset-btn" onclick="resetPomodoroTimer()">
                  リセット
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="title-right">
          <div id="header-links-container">
            <!-- ヘッダーリンクは動的に生成されます -->
          </div>
          <button class="action-btn edit-btn" onclick="editHeaderLinks()" title="ヘッダーリンク編集">✏️</button>
        </div>
      </div>
      
      <!-- ナビゲーションボタン群 -->
      <nav class="header-navigation">
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">メニュー ☰</button>

        <!-- 固定ボタン群 -->
        <div class="fixed-buttons-group" id="fixed-buttons-group">
          <!-- ナビゲーションボタンは動的に生成されます -->
        </div>
        
        <!-- 動的プロジェクトボタン群 -->
        <div class="dynamic-buttons-group">
          <a href="#main" class="navigation-link nav-tab" data-view="main">MyPage</a>
          <div id="project-links">
            <!-- プロジェクトタブは動的に生成されます -->
          </div>
        </div>
      </nav>
    </header>

    <main id="main-content">
      <!-- Main View -->
      <div id="main-view" class="view active">
        <div class="section-grid">
          <!-- 固定で6セクションを作成 -->
          <div class="section enhanced-section" id="mypage-section1" data-category="work">
            <div class="section-header">
              <div class="section-title-area">
                <h2 onclick="editSectionName('mypage-section1')" class="section-title-text">セクション1</h2>
                <input type="text" id="mypage-section1-input" class="section-name-input" onblur="saveSectionName('mypage-section1')" />
              </div>
              <div class="section-actions">
                <button class="action-btn edit-btn" onclick="editLinks('mypage-section1')" title="編集">✏️</button>
              </div>
            </div>
            <div class="link-grid">
              <!-- リンクは動的に生成されます -->
            </div>
          </div>
          <div class="section enhanced-section" id="mypage-section2" data-category="social">
            <div class="section-header">
              <div class="section-title-area">
                <h2 onclick="editSectionName('mypage-section2')" class="section-title-text">セクション2</h2>
                <input type="text" id="mypage-section2-input" class="section-name-input" onblur="saveSectionName('mypage-section2')" />
              </div>
              <div class="section-actions">
                <button class="action-btn edit-btn" onclick="editLinks('mypage-section2')" title="編集">✏️</button>
              </div>
            </div>
            <div class="link-grid">
              <!-- リンクは動的に生成されます -->
            </div>
          </div>
          <div class="section enhanced-section" id="mypage-section3" data-category="dev">
            <div class="section-header">
              <div class="section-title-area">
                <h2 onclick="editSectionName('mypage-section3')" class="section-title-text">セクション3</h2>
                <input type="text" id="mypage-section3-input" class="section-name-input" onblur="saveSectionName('mypage-section3')" />
              </div>
              <div class="section-actions">
                <button class="action-btn edit-btn" onclick="editLinks('mypage-section3')" title="編集">✏️</button>
              </div>
            </div>
            <div class="link-grid">
              <!-- リンクは動的に生成されます -->
            </div>
          </div>
          <div class="section enhanced-section" id="mypage-section4" data-category="entertainment">
            <div class="section-header">
              <div class="section-title-area">
                <h2 onclick="editSectionName('mypage-section4')" class="section-title-text">セクション4</h2>
                <input type="text" id="mypage-section4-input" class="section-name-input" onblur="saveSectionName('mypage-section4')" />
              </div>
              <div class="section-actions">
                <button class="action-btn edit-btn" onclick="editLinks('mypage-section4')" title="編集">✏️</button>
              </div>
            </div>
            <div class="link-grid">
              <!-- リンクは動的に生成されます -->
            </div>
          </div>
          <div class="section enhanced-section" id="mypage-section5" data-category="news">
            <div class="section-header">
              <div class="section-title-area">
                <h2 onclick="editSectionName('mypage-section5')" class="section-title-text">セクション5</h2>
                <input type="text" id="mypage-section5-input" class="section-name-input" onblur="saveSectionName('mypage-section5')" />
              </div>
              <div class="section-actions">
                <button class="action-btn edit-btn" onclick="editLinks('mypage-section5')" title="編集">✏️</button>
              </div>
            </div>
            <div class="link-grid">
              <!-- リンクは動的に生成されます -->
            </div>
          </div>
          <div class="section enhanced-section" id="mypage-section6" data-category="shopping">
            <div class="section-header">
              <div class="section-title-area">
                <h2 onclick="editSectionName('mypage-section6')" class="section-title-text">セクション6</h2>
                <input type="text" id="mypage-section6-input" class="section-name-input" onblur="saveSectionName('mypage-section6')" />
              </div>
              <div class="section-actions">
                <button class="action-btn edit-btn" onclick="editLinks('mypage-section6')" title="編集">✏️</button>
              </div>
            </div>
            <div class="link-grid">
              <!-- リンクは動的に生成されます -->
            </div>
          </div>
        </div>
      </div>

      <!-- Project Views -->
      <div id="project-views"></div>
    </main>

    <!-- モーダルポップアップ -->
    <div id="modal" class="modal">
      <div class="modal-content">
        <h3 id="modal-title">リンクの編集</h3>
        <div class="modal-body">
          <!-- 単一リンク編集モード -->
          <div id="single-edit-mode" class="single-edit-container" style="display: none;">
            <div class="current-link-info">
              <div class="info-label">📝 編集中のリンク</div>
              <div id="current-link-details" class="info-details"></div>
            </div>
            <div class="edit-form-container">
              <div class="form-row">
                <input type="text" id="edit-link-text" placeholder="リンクテキスト" />
                <input type="url" id="edit-link-url" placeholder="リンクURL" />
              </div>
              <div class="form-options">
                <label class="checkbox-container">
                  <input type="checkbox" id="edit-link-inline" />
                  <span class="checkmark"></span>
                  1行表示（コンパクト）
                </label>
              </div>
              <div class="form-buttons">
                <button id="save-edit-btn" onclick="saveEditedLink()">変更を保存</button>
                <button onclick="cancelSingleEdit()">キャンセル</button>
              </div>
            </div>
          </div>
          
          <!-- 通常の一覧編集モード -->
          <div id="list-edit-mode" class="list-edit-container">
            <div class="link-list-container">
              <ul id="modal-link-list"></ul>
            </div>
            <div class="add-link-form">
              <div class="form-row">
                <input type="text" id="new-link-text" placeholder="リンクテキスト" />
                <input type="url" id="new-link-url" placeholder="リンクURL" />
              </div>
              <div class="form-options">
                <label class="checkbox-container">
                  <input type="checkbox" id="new-link-inline" />
                  <span class="checkmark"></span>
                  1行表示（コンパクト）
                </label>
              </div>
              <div class="form-buttons">
                <button id="add-link-btn" onclick="addLink()">リンクを追加</button>
                <button onclick="cancelEdit()">キャンセル</button>
              </div>
            </div>
          </div>

          <!-- ヘッダーリンク編集モード -->
          <div id="header-links-edit-mode" class="header-edit-container" style="display: none;">
            <div class="header-links-list-container">
              <ul id="modal-header-link-list"></ul>
            </div>
            <div class="add-header-link-form">
              <div class="form-row">
                <input type="text" id="new-header-link-text" placeholder="リンクテキスト" />
                <input type="url" id="new-header-link-url" placeholder="リンクURL" />
              </div>
              <div class="form-buttons">
                <button id="add-header-link-btn" onclick="addHeaderLink()">リンクを追加</button>
                <button onclick="cancelHeaderEdit()">キャンセル</button>
              </div>
            </div>
          </div>

          <!-- ナビゲーション設定モード -->
          <div id="navigation-settings-mode" class="navigation-settings-container" style="display: none;">
            <div class="settings-description">
              <p>表示したいナビゲーションボタンにチェックを入れてください</p>
              <p class="drag-hint">⋮⋮ をドラッグして並び順を変更できます</p>
            </div>
            <div class="navigation-buttons-list">
              <ul id="navigation-buttons-settings"></ul>
            </div>
            <div class="settings-buttons">
              <button onclick="saveNavigationSettings()">設定を保存</button>
              <button onclick="resetNavigationSettings()">デフォルトに戻す</button>
              <button onclick="closeModal()">キャンセル</button>
            </div>
          </div>

          <!-- ポモドーロタイマー設定モード -->
          <div id="pomodoro-settings-mode" class="pomodoro-settings-container" style="display: none;">
            <div class="settings-description">
              <p>ポモドーロタイマーの動作時間を設定できます</p>
            </div>
            <div class="pomodoro-settings-form">
              <div class="setting-row">
                <label for="pomodoro-work-time">作業時間 (分):</label>
                <input type="number" id="pomodoro-work-time" min="1" max="60" value="25" />
              </div>
              <div class="setting-row">
                <label for="pomodoro-break-time">休憩時間 (分):</label>
                <input type="number" id="pomodoro-break-time" min="1" max="30" value="5" />
              </div>
              <div class="setting-row checkbox-row">
                <label for="pomodoro-auto-continue">
                  <input type="checkbox" id="pomodoro-auto-continue" />
                  自動継続（作業→休憩→作業を自動で繰り返す）
                </label>
              </div>
              <div class="setting-row checkbox-row">
                <label for="pomodoro-sound-enabled">
                  <input type="checkbox" id="pomodoro-sound-enabled" checked />
                  サウンド通知（タイマー完了時）
                </label>
              </div>
              <div class="setting-row checkbox-row">
                <label for="pomodoro-warning-sound-enabled">
                  <input type="checkbox" id="pomodoro-warning-sound-enabled" />
                  サウンド通知（残り20%時）
                </label>
              </div>
              <div class="setting-row checkbox-row">
                <label for="pomodoro-notification-enabled">
                  <input type="checkbox" id="pomodoro-notification-enabled" checked />
                  ブラウザ通知（アラート）を表示
                </label>
              </div>
              <div class="setting-row checkbox-row">
                <label for="pomodoro-timer-visible">
                  <input type="checkbox" id="pomodoro-timer-visible" checked />
                  ポモドーロタイマーを表示する
                </label>
              </div>
              <div class="settings-description" style="margin-top: 8px; padding: 8px; background-color: #e9ecef; border-radius: 4px;">
                <p style="margin: 0; font-size: 12px; color: #6c757d;">※ タイマーを非表示にした場合、再表示するにはナビゲーション設定からこの設定画面を開いてチェックを入れてください</p>
              </div>
            </div>
            <div class="settings-buttons">
              <button onclick="savePomodoroSettings()">設定を保存</button>
              <button onclick="resetPomodoroSettings()">デフォルトに戻す</button>
              <button onclick="closeModal()">キャンセル</button>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button onclick="closeModal()">閉じる</button>
        </div>
      </div>
    </div>

    <script src="js/storage-manager.js"></script>
    <script src="js/script.js"></script>
  </div>
</body>
<footer class="data-management">
  <button onclick="exportData()">エクスポート</button>
  <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)" />
  <button onclick="document.getElementById('importFile').click()">インポート</button>
  <button onclick="addNewProject()" class="add-project-footer-btn">ページ追加</button>
  <button onclick="showDeleteProjectDialog()" class="delete-project-footer-btn">ページ削除</button>
  <button onclick="openNavigationSettings()" class="navigation-settings-footer-btn">ナビゲーション設定</button>
</footer>
</html>
